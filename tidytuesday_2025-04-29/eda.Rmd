---
title: "eda.rmd"
author: "Ishita Khanna"
date: "`r Sys.Date()`"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
library(tidyverse)
library(shiny)

user2025 <- read_csv("data/user2025.csv") #reading the data set

glimpse(user2025) #overview
```

```{r sessions_by_date, echo=FALSE}
renderPlot({
  user2025 %>%
    count(date) %>%
    ggplot(aes(x = date, y = n)) +
    geom_col(fill = "steelblue") +
    labs(title = "Sessions by Date", x = "Date", y = "Number of Sessions") +
    theme_minimal() #sessions per date
})
```

```{top_keywords, echo=FALSE}
inputPanel(
  sliderInput("top_key", "Number of top keywords to display:", min = 5, max = 30, value = 10)
)

renderPlot({
  user2025 %>%
    separate_rows(keywords, sep = ";") %>%
    filter(keywords != "") %>%
    count(keywords, sort = TRUE) %>%
    slice_max(n, n = input$top_n) %>%
    ggplot(aes(x = reorder(keywords, n), y = n)) +
    geom_col(fill = "darkorange") +
    coord_flip() +
    labs(title = "Top Keywords", x = "Keyword", y = "Count") +
    theme_minimal() #interactive plot for top keywords
})
```